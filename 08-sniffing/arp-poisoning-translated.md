
# ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏î‡πâ‡∏ß‡∏¢ ARP Poisoning (ARP poisoning)

## ARP

- ARP ‡∏¢‡πà‡∏≠‡∏°‡∏≤‡∏à‡∏≤‡∏Å "Address Resolution Protocol"
- üìù ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà IP ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC ‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢
- ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `ARP_REQUEST` ‡πÅ‡∏•‡∏∞ `ARP_REPLY`
- ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á
  - `arp -a`: ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡∏ä ARP ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  - `arp -d *`: ‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏Ñ‡∏ä ARP

### ‡∏ï‡∏≤‡∏£‡∏≤‡∏á ARP (ARP table)

- ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC ‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà IP
- ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ü‡∏ã‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á ARP ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- üìù ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ARP:
  1. ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå A ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠ ARP ‡∏≠‡∏≠‡∏Å‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏ñ‡∏≤‡∏°‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà IP ‡πÄ‡∏â‡∏û‡∏≤‡∏∞
  2. ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå B ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC ‡πÅ‡∏•‡∏∞ IP ‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô
  3. ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå A ‡πÅ‡∏ó‡∏£‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡πâ‡∏ô‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á ARP ‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

## ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏î‡πâ‡∏ß‡∏¢ ARP poisoning

- ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠ ‚Ä¢ ***ARP spoofing*** ‚Ä¢¬†***ARP spoofing*** ‚Ä¢ ***ARP cache poisoning*** ‚Ä¢ ***ARP poison routing*** ‚Ä¢ ***ARP cache flooding*** ‚Ä¢ ***ARP flooding***.
- ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ Man in the middle ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå
- ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏°‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏Ñ‡∏ä ARP ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
- ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏à‡∏≤‡∏Å ARP ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
- ‡∏´‡∏≤‡∏Å‡πÅ‡∏Ñ‡∏ä ARP ‡πÄ‡∏ï‡πá‡∏° ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÑ‡∏î‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï/‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
  - ‡∏≠‡∏≤‡∏à [‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢](https://www.trendmicro.com/vinfo/se/threat-encyclopedia/archive/security-advisories/arp%20flooding%20attack)
    - ‡∏ó‡∏≥‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏Æ‡∏±‡∏ö i.e. ‡∏™‡πà‡∏á‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    - ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô [MAC flooding](./sniffing-attacks-overview.md#mac-flooding-attack)
  - ‡πÉ‡∏ô [Linux](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/neighbour.c#n388) ‡∏≠‡∏≤‡∏à:
    - ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î/‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÇ‡∏î‡∏¢ garbage collector)
    - ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏î‡πâ‡∏ß‡∏¢ ARP poisoning

1. **‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**
   1. ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà IP ‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô `192.168.122.183`
      - ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πà‡∏≤‡∏ô [‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `nmap`](./../03-scanning-networks/scanning-tools.md#-p-ping-host-discovery-options) ‡πÄ‡∏ä‡πà‡∏ô `nmap -sn 192.168.0.0/24`
   2. ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏Å‡∏ï‡πÄ‡∏ß‡∏¢‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô `192.168.122.1`
      - ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πà‡∏≤‡∏ô `ip route`
   3. ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC ‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô `00:05:ea:aa:bb:cc`
      - ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πà‡∏≤‡∏ô `arp-scan -l`
   4. ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà MAC ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏ß‡∏¢‡πå ‡πÄ‡∏ä‡πà‡∏ô `00:05:ea:dd:cc:bb`
      - ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πà‡∏≤‡∏ô `arp-scan -l`
2. **‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô**
   - ‡∏ö‡∏ô Debian / Ubuntu
     - `sudo apt install ettercap-graphical wireshark`
3. **‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï IP**
   - ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï IP ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏µ‡∏Å‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡∏´‡∏ô‡∏∂‡πà‡∏á
     - `echo 1 > /proc/sys/net/ipv4/ip_forward`
     - ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `sysctl` (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤)
       - `sysctl -w net.ipv4.ip_forward=1`
   - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÉ‡∏ô Windows ‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô
     - ‡∏ú‡πà‡∏≤‡∏ô‡∏£‡∏µ‡∏à‡∏¥‡∏™‡∏ó‡∏£‡∏µ (‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏°: `0x0` `0x1`)
       - `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\IPEnableRouter`
